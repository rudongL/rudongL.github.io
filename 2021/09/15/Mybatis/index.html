

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
  <title>Mybatis - Hexo</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"rudongl.github.io","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>rdleng'blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Mybatis">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-09-15 00:00" pubdate>
        September 15, 2021 am
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      10.5k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      166
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Mybatis</h1>
            
            <div class="markdown-body">
              <h1 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h1><p><a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/">MyBatis 官网</a></p>
<h2 id="MyBatis-Hello-World"><a href="#MyBatis-Hello-World" class="headerlink" title="MyBatis Hello World"></a>MyBatis Hello World</h2><h3 id="0-搭建环境"><a href="#0-搭建环境" class="headerlink" title="0. 搭建环境"></a>0. 搭建环境</h3><p>IDEA 使用 Maven 方式创建 Spring Boot 项目，添加 MyBatis 依赖。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--pom.xml--&gt;</span> <br><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.1.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br><span class="hljs-comment">&lt;!--SpringBoot 相关--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-comment">&lt;!--MyBatis 依赖--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!--MySQL 驱动类--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.16<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h6 id="引入-Flyway-插件"><a href="#引入-Flyway-插件" class="headerlink" title="引入 Flyway 插件"></a>引入 Flyway 插件</h6><p>通过 Flyway 记录数据库变化</p>
<p><a target="_blank" rel="noopener" href="https://flywaydb.org/">flyway 官网</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.flywaydb<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>flyway-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.5.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>jdbc:mysql://localhost:3306?serverTimezone=GMT<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br>                  <span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span>root<span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br>                  <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>                  <span class="hljs-tag">&lt;<span class="hljs-name">schemas</span>&gt;</span><br>					<span class="hljs-comment">&lt;!--存放历史信息--&gt;</span><br>                      <span class="hljs-tag">&lt;<span class="hljs-name">schema</span>&gt;</span>public<span class="hljs-tag">&lt;/<span class="hljs-name">schema</span>&gt;</span><br>                  <span class="hljs-tag">&lt;/<span class="hljs-name">schemas</span>&gt;</span><br>              <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>              <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>                  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>                      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.16<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>              <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>properties 文件路径：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">resources<br>		|------application.properties<br></code></pre></td></tr></table></figure>
<p>Flyway 配置：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># 值不能加引号，否则加注释时 target 目录不能自动解析导致 target 目录下 db.properties 带括号</span><br><span class="hljs-comment">#application.properties</span><br><span class="hljs-meta">spring.flyway.user</span>=<span class="hljs-string">root</span><br><span class="hljs-meta">spring.flyway.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-meta">spring.flyway.baseline-on-migrate</span>=<span class="hljs-string">true</span><br><span class="hljs-meta">spring.flyway.schemas</span>=<span class="hljs-string">public</span><br></code></pre></td></tr></table></figure>
<p>数据库配置文件 db.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># db.properties</span><br><span class="hljs-attr">driver</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br><span class="hljs-attr">url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306?serverTimezone=GMT</span><br><span class="hljs-attr">user</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">password</span>=<span class="hljs-string">123456</span><br></code></pre></td></tr></table></figure>
<p>Flyway 文件路径</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">resources<br>		|---db<br>			  |---migration<br>						|---V1__Create_table_person.sql;<br></code></pre></td></tr></table></figure>

<p>resources 下新建 SQL 文件： <code>db/migration/V1__Creat_table_person.sql</code>；（<strong>目录</strong>，不是包）。</p>
<p>修复 flyway:<code>mvn flyway:repair</code>，合并脚本: <code>mvn flyway:migrate</code> 配置 Schema<br>配置 mysql url <code>jdbc:mysql://localhost:3306?serverTimezone=GMT</code></p>
<h2 id="1-新建表、POJO-类，xXXMapper-xml"><a href="#1-新建表、POJO-类，xXXMapper-xml" class="headerlink" title="1. 新建表、POJO 类，xXXMapper.xml"></a>1. 新建表、POJO 类，xXXMapper.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--xxxMapper.xml--&gt;</span><br><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--该映射文件唯一标识符--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.rdleng.entity.personMapper&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--id为接口方法名--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryPersonById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.rdleng.entity.Person&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;Integer&quot;</span>&gt;</span><br>        select * from public.person where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="2-配置-MyBatis-xml-文件"><a href="#2-配置-MyBatis-xml-文件" class="headerlink" title="2.配置 MyBatis.xml 文件"></a>2.配置 MyBatis.xml 文件</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--mybatis.xml--&gt;</span><br><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--加载数据库配置文件--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--事务管理--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;</span><br>            <span class="hljs-comment">&lt;!--配置数据源--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;user&#125;&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--加载映射文件--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;personMapper.xml&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="3-测试"><a href="#3-测试" class="headerlink" title="3.测试"></a>3.测试</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.rdleng.test;<br><br><span class="hljs-keyword">import</span> com.rdleng.entity.Person;<br><span class="hljs-keyword">import</span> org.apache.ibatis.io.Resources;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.Reader;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-09-09 19:27</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestMybatis</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">/*加载 Mybatis 配置文件*/</span><br>        Reader reader = Resources.getResourceAsReader(<span class="hljs-string">&quot;mybatis.xml&quot;</span>);<br>        SqlSessionFactory factory = (SqlSessionFactory) <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder().build(reader);<br>        SqlSession session = factory.openSession();<br>        <span class="hljs-comment">//namespace+id,sql参数值</span><br>        String statement = <span class="hljs-string">&quot;com.rdleng.entity.personMapper.queryPersonById&quot;</span>;<br>        Person person = session.selectOne(statement,<span class="hljs-number">1</span>);<br>        System.out.println(person);<br>        session.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>MyBatis 约定 &gt; 配置 &gt; 硬编码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//创建接口，接口名与 xxxMapper.xml 一致，方法名与 id 一致，参数类型，返回值类型一致</span><br><span class="hljs-keyword">package</span> com.rdleng.mapper;<br><br><span class="hljs-keyword">import</span> com.rdleng.entity.Student;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-09-10 9:47</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">StudentMapper</span> </span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id 学生 id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@description</span> 根据 id 查询学生</span><br><span class="hljs-comment">     * 1.方法名与 mapper.xml 中 id 一致</span><br><span class="hljs-comment">     * 2.参数类型与 sql 输入参数类型一致</span><br><span class="hljs-comment">     * 3.返回值与 mapper.xml 中 resultType 一致</span><br><span class="hljs-comment">     * 4.接口名与 mapper.xml 中 namespace 一致</span><br><span class="hljs-comment">     * 5.根据方法名找到 mapper.xml 中对应的 sql 标签</span><br><span class="hljs-comment">     * 6.mapper.xml 和接口通常放在同一个包中</span><br><span class="hljs-comment">     * */</span><br>    <span class="hljs-function">Student <span class="hljs-title">queryStudentById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>SpringBoot 集成 MyBatis 找不到 xml 文件的解决方法：pom.xml 文件添加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span> <br>	<span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.rdleng.test;<br><br><span class="hljs-keyword">import</span> com.rdleng.entity.Student;<br><span class="hljs-keyword">import</span> com.rdleng.mapper.StudentMapper;<br><span class="hljs-keyword">import</span> org.apache.ibatis.io.Resources;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.Reader;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *测试 MyBatis 约定优于配置</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-09-10 10:01</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestMybatis</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        Reader reader = Resources.getResourceAsReader(<span class="hljs-string">&quot;conf.xml&quot;</span>);<br>        SqlSessionFactory factory = <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder().build(reader);<br>        SqlSession session = factory.openSession();<br>        StudentMapper mapper = session.getMapper(StudentMapper.class);<br>        Student student = mapper.queryStudentById(<span class="hljs-number">1</span>);<br>        System.out.println(student);<br>        session.close();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><code>StudentMapper mapper = session.getMapper(StudentMapper.class);重点</code></p>
<p>优化</p>
<ol>
<li><p>可以将配置信息单独放入 <code>db.properties</code> 文件中，然后动态引入 db.properties。k=v，引入后，使用 ${key} 取值。</p>
</li>
<li><p>config.xml 中 <code>&lt;properties/&gt;</code> 下，<code>&lt;enviroments/&gt;</code> 上添加 <code>&lt;settings&gt;&lt;setting name=&quot;&quot; value=&quot;&quot;/&gt;&lt;/settings&gt;</code> 设置全局参数。</p>
</li>
<li><p>别名：全局参数中配置，不区分大小写。</p>
</li>
</ol>
<ul>
<li><p>设置单个别名 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--单独配置别名，忽略大小写--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">typeAlias</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.rdleng.entity.Student&quot;</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">&quot;student&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>批量设置别名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--批量配置别名，忽略大小写；包括包和子包--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.rdleng.entity&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="类型转换器"><a href="#类型转换器" class="headerlink" title="类型转换器"></a>类型转换器</h5></li>
</ul>
<ol>
<li><p>自定义类型转换器<br>用于 Java 中属性和数据库字段不一致的情况，例如：Java 代码 (boolean true:男，false:女) &lt;-&gt; DB (int 1:男，2：女)</p>
<ul>
<li>实现<code>TypeHandler</code>接口</li>
<li>继承<code>BaseTypeHandler&lt;java类型&gt;</code>抽象类</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.rdleng.converter;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.type.BaseTypeHandler;<br><span class="hljs-keyword">import</span> org.apache.ibatis.type.JdbcType;<br><span class="hljs-keyword">import</span> java.sql.CallableStatement;<br><span class="hljs-keyword">import</span> java.sql.PreparedStatement;<br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment">* <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment">* <span class="hljs-doctag">@create</span> 2020-09-11 12:30</span><br><span class="hljs-comment">*/</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">java代码(boolean true:男，false:女) &lt;-&gt; DB(int 1:男，2：女)</span><br><span class="hljs-comment">泛型为java类型</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BooleanAndIntConverter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseTypeHandler</span>&lt;<span class="hljs-title">Boolean</span>&gt;</span>&#123;<br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setNonNullParameter</span><span class="hljs-params">(PreparedStatement preparedStatement, <span class="hljs-keyword">int</span> i, Boolean aBoolean, JdbcType jdbcType)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>	   <span class="hljs-keyword">if</span> (aBoolean)&#123;<br>		   preparedStatement.setInt(i,<span class="hljs-number">1</span>);<br>	   &#125;<span class="hljs-keyword">else</span>&#123;<br>		   preparedStatement.setInt(i,<span class="hljs-number">0</span>);<br>	   &#125;<br>   &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">getNullableResult</span><span class="hljs-params">(ResultSet resultSet, String s)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>	   <span class="hljs-keyword">int</span> sexNum = resultSet.getInt(s);<br>	   <span class="hljs-keyword">return</span> sexNum == <span class="hljs-number">1</span>;<br>   &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">getNullableResult</span><span class="hljs-params">(ResultSet resultSet, <span class="hljs-keyword">int</span> i)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>	   <span class="hljs-keyword">int</span> sexInt = resultSet.getInt(i);<br>	   <span class="hljs-keyword">return</span> sexInt == <span class="hljs-number">1</span>;<br>   &#125;<br><br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">getNullableResult</span><span class="hljs-params">(CallableStatement callableStatement, <span class="hljs-keyword">int</span> i)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>	   <span class="hljs-keyword">int</span> sexNum = callableStatement.getInt(i);<br>	   <span class="hljs-keyword">return</span> sexNum == <span class="hljs-number">1</span>;<br>   &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>配置config.xml</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>    <br><span class="hljs-tag">&lt;<span class="hljs-name">typeHandlers</span>&gt;</span><br>	   <span class="hljs-tag">&lt;<span class="hljs-name">typeHandler</span> <span class="hljs-attr">handler</span>=<span class="hljs-string">&quot;com.rdleng.converter.BooleanAndIntConverter&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;boolean&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;int&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">typeHandlers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="3">
<li><p>修改<code>studentMapper.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--若java代码与sql数据类型一致，则使用resultType；若不一致则使用resultMap--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryStudentByIdWithTypeConverter&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;studentResult&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span>&gt;</span><br>        select *<br>        from people.student<br>        where stuId = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;studentResult&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;student&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--分为主键和非主键--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuId&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuId&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuNum&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuNum&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuName&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuName&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuClass&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuClass&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;phoneNum&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;phoneNum&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuSex&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuSex&quot;</span>  <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;Boolean&quot;</span> <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">&quot;INTEGER&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!--对象类型一对一用association,一对多用collection--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;address&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;homeAddress&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;homeAddress&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;schoolAddress&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;schoolAddress&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">association</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="输入参数：parameterType"><a href="#输入参数：parameterType" class="headerlink" title="输入参数：parameterType"></a>输入参数：parameterType</h2><p>1.类型为 简单类型（8个基本类型+String）<br>#{}、${}的区别</p>
<ul>
<li><p>#{任意值}<br>${value} ，其中的标识符只能是value</p>
</li>
<li><p>#{}自动给String类型加上’’  （自动类型转换）<br>${} 原样输出，但是适合于 动态排序（动态字段）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> stuno,stuname,stuage  <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> stuname <span class="hljs-operator">=</span> #&#123;<span class="hljs-keyword">value</span>&#125;<br><span class="hljs-keyword">select</span> stuno,stuname,stuage  <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> stuname <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;$&#123;value&#125;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>动态排序：<br><code>select stuno,stuname,stuage  from student  order by $&#123;value&#125; asc</code></p>
</li>
<li><p>#{}可以防止SQL注入；${}不防止</p>
</li>
</ul>
<p>${}、#{}相同之处：<br>a.都可以 获取对象的值 （嵌套类型对象）</p>
<p>i.获取对象值：<br>模糊查询，方式一：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> stuno,stuname,stuage  <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> stuage<span class="hljs-operator">=</span> #&#123;stuAge&#125;  <span class="hljs-keyword">or</span> stuname <span class="hljs-keyword">like</span> #&#123;stuName&#125; <br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Student student = <span class="hljs-keyword">new</span> Student();<br>student.setStuAge(<span class="hljs-number">24</span>);<br>student.setStuName(<span class="hljs-string">&quot;%w%&quot;</span>);<br>List&lt;Student&gt; students = studentMapper.queryStudentBystuageOrstuName(student) ;<span class="hljs-comment">//接口的方法-&gt;SQL</span><br></code></pre></td></tr></table></figure>


<p>模糊查询，方式二：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> stuno,stuname,stuage  <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> stuage<span class="hljs-operator">=</span> #&#123;stuAge&#125;  <span class="hljs-keyword">or</span> stuname <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%$&#123;stuName&#125;%&#x27;</span><br></code></pre></td></tr></table></figure>

<p>ii.嵌套类型对象</p>
<p>2.对象类型<br>#{属性名}<br>${属性名}</p>
<p>输入对象为HashMap:<br>where stuage= # {stuAge}<br>用map中key的值匹配占位符# {stuAge}， 如果匹配成功就用map的value替换占位符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">&lt;</span><span class="hljs-keyword">select</span> id<span class="hljs-operator">=</span>&quot;queryStudentByAgeOrNameWithHashMap&quot; resultType<span class="hljs-operator">=</span>&quot;student&quot; parameterType<span class="hljs-operator">=</span>&quot;HashMap&quot;<span class="hljs-operator">&gt;</span><br>	<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> people.student <span class="hljs-keyword">where</span> stuAge <span class="hljs-operator">=</span> #&#123;stuAge&#125; <span class="hljs-keyword">or</span> stuName <span class="hljs-keyword">like</span>  <span class="hljs-string">&#x27;%$&#123;stuName&#125;%&#x27;</span><br><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span><span class="hljs-keyword">select</span><span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">HashMap&lt;String, Object&gt; hashMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>hashMap.put(<span class="hljs-string">&quot;&#x27;stuAge&quot;</span>,<span class="hljs-number">21</span>);<br>hashMap.put(<span class="hljs-string">&quot;stuName&quot;</span>,<span class="hljs-string">&quot;l&quot;</span>);<br>System.out.println(mapper.queryStudentByAgeOrNameWithHashMap(hashMap));<br></code></pre></td></tr></table></figure>

<p>Mybatis调用存储过程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> replace <span class="hljs-keyword">procedure</span> queryCountByGradeWithProcedure (gName <span class="hljs-keyword">in</span> <span class="hljs-type">varchar</span>, scount <span class="hljs-keyword">out</span> number )<br><span class="hljs-keyword">as</span><br><span class="hljs-keyword">begin</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">into</span> scount <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> graname <span class="hljs-operator">=</span> gname ;<br><span class="hljs-keyword">end</span>; <span class="hljs-operator">/</span><br></code></pre></td></tr></table></figure>

<p>设置mapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--通过调用存储过程，实现查询，statementType=&quot;CALLABLE&quot;</span><br><span class="hljs-comment">	输入参数在Mybatis中通常用HashMap&lt;String,Object&gt;--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryCountByGradeWithProcedure&quot;</span> <span class="hljs-attr">statementType</span>=<span class="hljs-string">&quot;CALLABLE&quot;</span>  <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;HashMap&quot;</span>&gt;</span><br>	call people.queryCountByGradeWithProcedure(<br>    #&#123;stuClass,jdbcType=INTEGER,mode=IN&#125;,<br>    #&#123;sCount,jdbcType=INTEGER,mode=OUT&#125;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>配置接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//    根据存储过程查询某个年级的学生总数</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">queryCountByGradeWithProcedure</span><span class="hljs-params">(Map&lt;String, Object&gt; params)</span></span>;<br></code></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//在使用时，通过hashmap的put方法传入输入参数的值;通过hashmap的Get方法获取输出参数的值</span><br>HashMap&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>map.put(<span class="hljs-string">&quot;stuClass&quot;</span>,<span class="hljs-number">2</span>);<br>mapper.queryCountByGradeWithProcedure(map);<br>Object count = map.get(<span class="hljs-string">&quot;sCount&quot;</span>);<br>System.out.println(count);<br></code></pre></td></tr></table></figure>

<h5 id="动态sql"><a href="#动态sql" class="headerlink" title="动态sql"></a>动态sql</h5><h6 id="where、if"><a href="#where、if" class="headerlink" title="where、if"></a>where、if</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span><span class="hljs-comment">--方式一：使用&lt;where&gt;标签，但是此标签只会自动处理第一个&lt;if&gt;标签中的and--&gt;</span><br><span class="hljs-operator">&lt;</span><span class="hljs-keyword">select</span> id<span class="hljs-operator">=</span>&quot;queryStudentByStuNameAndStuNumWithSQLTag&quot; parameterType<span class="hljs-operator">=</span>&quot;student&quot; resultType<span class="hljs-operator">=</span>&quot;hashmap&quot;<span class="hljs-operator">&gt;</span><br>        <span class="hljs-keyword">select</span> stuNum num,stuName name <span class="hljs-keyword">from</span> people.student<br>        <span class="hljs-operator">&lt;</span><span class="hljs-keyword">where</span><span class="hljs-operator">&gt;</span><br>            <span class="hljs-operator">&lt;</span>if test<span class="hljs-operator">=</span>&quot;stuName!=null and stuName!=&#x27;&#x27; &quot;<span class="hljs-operator">&gt;</span><br>                <span class="hljs-keyword">and</span> stuName<span class="hljs-operator">=</span>#&#123;stuName&#125;<br>            <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>if<span class="hljs-operator">&gt;</span><br>            <span class="hljs-operator">&lt;</span>if test<span class="hljs-operator">=</span>&quot;stuNum != null and stuNum!=&#x27;&#x27; &quot;<span class="hljs-operator">&gt;</span><br>                <span class="hljs-keyword">and</span> stuNum <span class="hljs-operator">=</span> #&#123;stuNum&#125;<br>            <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>if<span class="hljs-operator">&gt;</span><br>        <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span><span class="hljs-keyword">where</span><span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span><span class="hljs-keyword">select</span><span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span><span class="hljs-comment">--方式二：使用where 1 = 1,所有if标签都加and --&gt;</span><br>    <span class="hljs-operator">&lt;</span><span class="hljs-keyword">select</span> id<span class="hljs-operator">=</span>&quot;queryStudentByStuNameAndStuNumWithSQLTag&quot; parameterType<span class="hljs-operator">=</span>&quot;student&quot; resultType<span class="hljs-operator">=</span>&quot;hashmap&quot;<span class="hljs-operator">&gt;</span><br>        <span class="hljs-keyword">select</span> stuNum num,stuName name <span class="hljs-keyword">from</span> people.student <span class="hljs-keyword">where</span> <span class="hljs-number">1</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>            <span class="hljs-operator">&lt;</span>if test<span class="hljs-operator">=</span>&quot;stuName!=null and stuName!=&#x27;&#x27; &quot;<span class="hljs-operator">&gt;</span><br>                <span class="hljs-keyword">and</span> stuName<span class="hljs-operator">=</span>#&#123;stuName&#125;<br>            <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>if<span class="hljs-operator">&gt;</span><br>            <span class="hljs-operator">&lt;</span>if test<span class="hljs-operator">=</span>&quot;stuNum != null and stuNum!=&#x27;&#x27; &quot;<span class="hljs-operator">&gt;</span><br>                <span class="hljs-keyword">and</span> stuNum <span class="hljs-operator">=</span> #&#123;stuNum&#125;<br>            <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>if<span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span><span class="hljs-keyword">select</span><span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure>

<h6 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h6><p>迭代的类型：数组、对象数组、集合、属性（Grade类：List<Integer> ids）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span><span class="hljs-comment">--将多个元素放入对象的属性--&gt;</span><br><span class="hljs-operator">&lt;</span><span class="hljs-keyword">select</span> id<span class="hljs-operator">=</span>&quot;queryStudentByStuIdInGrade&quot; parameterType<span class="hljs-operator">=</span>&quot;grade&quot; resultType<span class="hljs-operator">=</span>&quot;student&quot;<span class="hljs-operator">&gt;</span><br>        <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> people.student <span class="hljs-keyword">where</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><br>        <span class="hljs-operator">&lt;</span>if test<span class="hljs-operator">=</span>&quot;stuId!=null and stuId.size &gt; 0&quot;<span class="hljs-operator">&gt;</span><br>            <span class="hljs-operator">&lt;</span>foreach collection<span class="hljs-operator">=</span>&quot;stuId&quot; item<span class="hljs-operator">=</span>&quot;stuId&quot; <span class="hljs-keyword">open</span><span class="hljs-operator">=</span>&quot; and stuId in (&quot; <span class="hljs-keyword">close</span><span class="hljs-operator">=</span>&quot;)&quot; separator<span class="hljs-operator">=</span>&quot;,&quot;<span class="hljs-operator">&gt;</span><br>                #&#123;stuId&#125;<br>            <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>foreach<span class="hljs-operator">&gt;</span><br>        <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>if<span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span><span class="hljs-keyword">select</span><span class="hljs-operator">&gt;</span><br>    <span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span><span class="hljs-comment">--简单类型的数组：无论在编写代码时，传递的时什么参数名（stuId）,在mapper.xml文件中，必须用array代替该数组；集合：无论在编写代码时，传递的时什么参数名（stuId）,在mapper.xml文件中，必须用list代替该集合；对象类型数组必须为parameterType=&quot;Object[]&quot;，item=&quot;student&quot;--&gt;</span><br></code></pre></td></tr></table></figure>

<h6 id="trim"><a href="#trim" class="headerlink" title="trim"></a>trim</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--trim既可以处理第一个and又可以处理最后一个and;</span><br><span class="hljs-comment">	处理第一个and时， prefix=&quot;where&quot;表示给sql语句添加where;</span><br><span class="hljs-comment">		prefixOverrides=&quot;and&quot;表示处理第一个and;--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;where&quot;</span> <span class="hljs-attr">prefixOverrides</span>=<span class="hljs-string">&quot;and&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;stuName != nul1 and stuName!=&#x27;&#x27;&quot;</span>&gt;</span><br>		and stuName like &#x27;%$&#123;stuName&#125;$%&#x27; <br>	<span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;graName != null and graName !=&#x27;&#x27;&quot;</span>&gt;</span> <br>		and qraName like &#x27;%$&#123;graName&#125;$%&#x27;<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;stuAge != null and stuAge!= &#x27;&#x27;&quot;</span>&gt;</span><br>		and stuAge = # &#123;stuAge&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br><span class="hljs-comment">&lt;!--处理最后一个and时，suffixOverrides=&quot;and&quot;表示处理最后一个&quot;and&quot;--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">trim</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;where&quot;</span> <span class="hljs-attr">prefixOverrides</span>=<span class="hljs-string">&quot;and&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;stuName != nul1 and stuName!=&#x27;&#x27;&quot;</span>&gt;</span><br>		 stuName like &#x27;%$&#123;stuName&#125;$%&#x27; and<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;graName != null and graName !=&#x27;&#x27;&quot;</span>&gt;</span> <br>		 qraName like &#x27;%$&#123;graName&#125;$%&#x27; and<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;stuAge != null and stuAge!= &#x27;&#x27;&quot;</span>&gt;</span><br>		 stuAge = # &#123;stuAge&#125; and<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">trim</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>输出参数resultType<br>1.简单类型（8个基本+String）<br>2.输出参数为实体对象类型<br>3.输出参数为实体对象类型的集合 ：虽然输出类型为集合，但是resultType依然写 集合的元素类型（resyltType=”Student”）<br>4.输出参数类型为HashMap<br>    –HashMap本身是一个集合，可以存放多个元素，<br>      但是根据提示发现  返回值为HashMap时  ，查询的结果只能是1个学生（no,name）；<br>–&gt;结论：一个HashMap 对应一个学生的多个元素（多个属性）  【一个map，一个学生】</p>
<p>二维数组<br>{<br>    {1,zs,23,xa},    -一个HashMap对象<br>    {2,ls,24,bj},<br>    {3,ww,25,tj}<br>}</p>
<p>resultType<br>resultMap:实体类的属性、数据表的字段： 类型、名字不同时（stuno,id）<br>注意：当属性名 和字段名 不一致时，除了使用resultMap以外，还可以使用resultType+HashMap:</p>
<p>a.resultMap</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;resultMap type=<span class="hljs-string">&quot;student&quot;</span> id=<span class="hljs-string">&quot;queryStudentByIdMap&quot;</span>&gt;<br>		&lt;!-- 指定类中的属性 和 表中的字段 对应关系 --&gt;<br>		&lt;id property=<span class="hljs-string">&quot;stuNo&quot;</span>  column=<span class="hljs-string">&quot;id&quot;</span> /&gt;<br>		&lt;result property=<span class="hljs-string">&quot;stuName&quot;</span> column=<span class="hljs-string">&quot;name&quot;</span> /&gt;<br>&lt;/resultMap&gt;<br></code></pre></td></tr></table></figure>

<p>​<br>b.resultType+HashMap<br>select  表的字段名 “类的属性名” from… 来制定字段名 和属性名的对应关系</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryStudentByIdWithHashMap&quot;</span> 	 <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span>	<span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;student&quot;</span> &gt;</span><br>		select id &quot;stuNo&quot;,name &quot;stuName&quot; from student where id = #&#123;id&#125;<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>


<p>注意:  如果如果10个字段，但发现 某一个字段结果始终为默认值（0，0.0，null），则可能是 表的字段  和 类的属性名字写错。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//查询全部</span><br>String statement = <span class="hljs-string">&quot;select stuno,stuname from student&quot;</span>;<br><span class="hljs-comment">//根据年龄查询学生</span><br>String statement = <span class="hljs-string">&quot;select stuno,stuname from student where stuage = #&#123;stuage&#125;&quot;</span>; <br><span class="hljs-comment">//根据姓名和年龄查询学生</span><br>String statement = <span class="hljs-string">&quot;select stuno,stuname from student where stuage = #&#123;stuage&#125; and stuage = #&#123;stuage&#125; &quot;</span>; <br></code></pre></td></tr></table></figure>

<p>select stuno,stuname from student where  stuname = #{stuName}and  stuage = #{stuAge}</p>
<p>select stuno,stuname,stuage from student <where> and stuname = #{stuName}  and  stuage = #{stuAge}</p>
<p><where>会自动处理第一个<if>标签中的 and，但不会处理之后<if>中的and</p>
<p><code>&lt;foreach&gt;</code><br>查询学号为1、2、53的学生信息</p>
<p><code>ids = &#123;1,2,53&#125;;</code></p>
<p><code>select stuno,stuname from student  where stuno in(1,2,53) </code></p>
<p><code>&lt;foreach&gt;</code>迭代的类型：数组、对象数组、集合、属性(Grade类： <code>List&lt;Integer&gt; ids</code>)</p>
<p>属性(Grade类： <code>List&lt;Integer&gt; ids</code>)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> student <br><span class="hljs-keyword">open</span>:<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> student <span class="hljs-keyword">and</span>  stuno <span class="hljs-keyword">in</span> (<br>item:<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> student <span class="hljs-keyword">and</span>  stuno <span class="hljs-keyword">in</span> (<span class="hljs-number">1253</span><br><span class="hljs-keyword">close</span>:<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> student <span class="hljs-keyword">and</span>  stuno <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">53</span>)<br></code></pre></td></tr></table></figure>

<p>简单类型的数组:<br>无论编写代码时，传递的是什么参数名(stuNos)，在mapper.xml中 必须用array代替该数组</p>
<p>集合：<br>无论编写代码时，传递的是什么参数名(stuNos)，在mapper.xml中 必须用list代替该数组</p>
<p>对象数组：<br>Student[] students = {student0,student1,student2}  每个studentx包含一个学号属性<br>注意的几点：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">parameterType<span class="hljs-operator">=</span>&quot;Object[]&quot; <br>	 	<span class="hljs-operator">&lt;</span>foreach collection<span class="hljs-operator">=</span>&quot;array&quot; <span class="hljs-keyword">open</span><span class="hljs-operator">=</span>&quot; and  stuno in (&quot; <span class="hljs-keyword">close</span><span class="hljs-operator">=</span>&quot;)&quot; <br>	  		 		item<span class="hljs-operator">=</span>&quot;student&quot; separator<span class="hljs-operator">=</span>&quot;,&quot;<span class="hljs-operator">&gt;</span>   <br>	  		 		#&#123;student.stuNo&#125;<br>	  	<span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>foreach<span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure>

<p>SQL片段：<br>    java：方法<br>    数据库：存储过程、存储函数<br>    Mybatis :SQL片段 </p>
<p>a.提取相似代码<br>b.引用</p>
<p>关联查询：<br>一对一:<br>a.业务扩展类<br>        核心：用resultType指定类的属性 包含 多表查询的所有字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.rdleng.entity;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-09-23 8:55</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudentBusiness</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Student</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> cardId;<br>    <span class="hljs-keyword">private</span> String stuDesc;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getCardId</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> cardId;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCardId</span><span class="hljs-params">(<span class="hljs-keyword">int</span> cardId)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.cardId = cardId;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getStuDesc</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> stuDesc;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setStuDesc</span><span class="hljs-params">(String stuDesc)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.stuDesc = stuDesc;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.toString()+<span class="hljs-string">&quot;StudentBuiness&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;cardId=&quot;</span> + cardId +<br>                <span class="hljs-string">&quot;, stuDesc=&#x27;&quot;</span> + stuDesc + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>mapper文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryStudentByStuIdWithOO&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;StudentBusiness&quot;</span>&gt;</span><br>        select people.student.*, people.stucard.*<br>        from people.student<br>                 inner join people.stucard on student.cardId = stucard.cardId<br>        where people.student.stuId = #&#123;stuId&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">List&lt;Student&gt; <span class="hljs-title">queryStudentByStuIdWithOO</span><span class="hljs-params">(<span class="hljs-keyword">int</span> stuId)</span></span>;<br></code></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">System.out.println(mapper.queryStudentByStuIdWithOO(<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure>

<p>b.resultMap</p>
<p>一对多</p>
<p>（MyBatis:多对一，多对多的本质就是  一对多的变化）</p>
<p>pojo</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.rdleng.entity;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-09-23 11:13</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClassBusiness</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> classId;<br>    <span class="hljs-keyword">private</span> String className;<br>    <span class="hljs-keyword">private</span> List&lt;Student&gt; students;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Student&gt; <span class="hljs-title">getStudents</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> students;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setStudents</span><span class="hljs-params">(List&lt;Student&gt; students)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.students = students;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ClassBusiness&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;classId=&quot;</span> + classId +<br>                <span class="hljs-string">&quot;, className=&#x27;&quot;</span> + className + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, students=&quot;</span> + students +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>mapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryClassAndStudentByClassIdOM&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;class_to_student&quot;</span>&gt;</span><br>        select c.*,s.*<br>        from people.student s<br>                 inner join people.class c on s.classId = c.classId<br>        where s.classId = #&#123;classId&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;class_to_student&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;classBusiness&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;classId&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;classId&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;className&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;className&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!--属性中的元素类型用ofType--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;students&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;student&quot;</span> &gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuNum&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuNum&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuAge&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuAge&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuName&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuName&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuClass&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuClass&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuSex&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuSex&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p> interface</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">ClassBusiness <span class="hljs-title">queryClassAndStudentByClassIdOM</span><span class="hljs-params">(<span class="hljs-keyword">int</span> classId)</span></span>;<br></code></pre></td></tr></table></figure>

<p>test</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">ClassBusiness classBusiness = mapper.queryClassAndStudentByClassIdOM(<span class="hljs-number">2</span>);<br>List&lt;Student&gt; students = classBusiness.getStudents();<br><span class="hljs-keyword">for</span> (Student student : students) &#123;            			System.out.println(student.getStuNum()+<span class="hljs-string">&quot;,&quot;</span>+student.getStuName()+<span class="hljs-string">&quot;,&quot;</span>+student.getStuAge());<br>&#125;<br></code></pre></td></tr></table></figure>



<h5 id="日志：Log4j"><a href="#日志：Log4j" class="headerlink" title="日志：Log4j"></a>日志：Log4j</h5><p>a.Log4j:    log4j.jar (mybatis.zip中lib中包含此jar)或使用maven</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.17<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>b.开启日志，conf.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 开启日志，并指定使用的具体日志 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;LOG4J&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>如果不指定，Mybatis就会根据以下顺序 寻找日志<br>SLF4J →Apache Commons Logging →Log4j 2 → Log4j →JDK logging</p>
<p>c.编写配置日志输出文件<br>log4j.properties，内容</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-meta">log4j.rootLogger</span>=<span class="hljs-string">DEBUG, stdout</span><br><span class="hljs-meta">log4j.appender.stdout</span>=<span class="hljs-string">org.apache.log4j.ConsoleAppender</span><br><span class="hljs-meta">log4j.appender.stdout.layout</span>=<span class="hljs-string">org.apache.log4j.PatternLayout</span><br><span class="hljs-meta">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="hljs-string">%5p [%t] - %m%n</span><br></code></pre></td></tr></table></figure>

<p>日志级别：<br>    DEBUG&lt;INFO&lt;WARN&lt;ERROR<br>如果设置为info，则只显示 info及以上级别的信息；<br>建议：在开发时设置debug，在运行时设置为info或以上。</p>
<p>可以通过日志信息，相信的阅读mybatis执行情况（ 观察mybatis实际执行sql语句 以及SQL中的参数 和返回结果）</p>
<h5 id="延迟加载（懒加载）："><a href="#延迟加载（懒加载）：" class="headerlink" title="延迟加载（懒加载）："></a>延迟加载（懒加载）：</h5><p>一对一、一对多、多对一、多对多<br>一对多：班级-学生 ，<br>如果不采用延迟加载  （立即加载），查询时会将 一 和多 都查询，班级、班级中的所有学生。<br>如果想要  暂时只查询1的一方，  而多的一方 先不查询 而是在需要的时候再去查询 –&gt;延迟加载</p>
<p>一对一：学生、学生证</p>
<p>mybatis中使用延迟加载，需要先配置：</p>
<p>如果增加了mapper.xml ,要修改conf.xml配置文件（将新增的mapper.xml加载进去）</p>
<p>通过debug可以发现， 如果程序只需要学生，则只向数据库发送了查询学生的SQL；<br>当我们后续 需要用到学生证的时候，再第二次发送 查询学生证的SQL。</p>
<p>一对多：和一对一的延迟加载配置方法相同</p>
<p>延迟加载的步骤：先查班级，按需查询学生<br>1.开启延迟加载conf.xml配置settings</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>		<span class="hljs-comment">&lt;!-- 开启延迟加载 --&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;lazyLoadingEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br>		<br>		<span class="hljs-comment">&lt;!-- 关闭立即加载 --&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;aggressiveLazyLoading&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>2.加载映射文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;com/rdleng/mapper/StudentCardMapper.xml&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<p>3.配置mapper.xml<br>    写2个Mapper:</p>
<p>StudentCardMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--该映射文件的唯一标识符--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.rdleng.mapper.StudentCardMapper&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryCardByCardId&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;StudentCard&quot;</span>&gt;</span><br>    select * from people.stucard where cardId = #&#123;cardId&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>StudentMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--select=&quot;com.rdleng.mapper.StudentCardMapper.queryCardByCardId&quot; column=&quot;cardId&quot;&gt;选择对应的sql语句，根据外键cardId传参数；首先查询学生，延迟查询学生证--&gt;</span> <br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryStudentByStuIdWithLazyLoadOO&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;student_card_lazy_load_map&quot;</span>  &gt;</span><br>        select *<br>        from people.student<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;student_card_lazy_load_map&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;student&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuId&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuId&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuNum&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuNum&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuName&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuName&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuAge&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuAge&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuCard&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;StudentCard&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;com.rdleng.mapper.StudentCardMapper.queryCardByCardId&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;cardId&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;cardId&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;cardId&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuDesc&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;stuDesc&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">association</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>4.配置接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">List&lt;Student&gt; <span class="hljs-title">queryStudentByStuIdWithLazyLoadOO</span><span class="hljs-params">()</span></span>;<br><span class="hljs-function">StudentCard <span class="hljs-title">queryCardByCardId</span><span class="hljs-params">(<span class="hljs-keyword">int</span> cardId)</span></span>;<br></code></pre></td></tr></table></figure>

<p>5.测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Student&gt; students1 =  mapper.queryStudentByStuIdWithLazyLoadOO();<br><span class="hljs-keyword">for</span> (Student student : students1) &#123;<br>	System.out.println(student.getStuNum() + <span class="hljs-string">&quot;,&quot;</span> + student.getStuName());<br>	StudentCard card = student.getStuCard();<br>	System.out.println(card.getCardId() + <span class="hljs-string">&quot;,&quot;</span> + card.getStuDesc());<br>        &#125;<br></code></pre></td></tr></table></figure>

<p>一对多延迟加载示例：</p>
<p>POJO</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.rdleng.entity;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-09-23 15:13</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Clazz</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> classId;<br>    <span class="hljs-keyword">private</span> String className;<br>    <span class="hljs-keyword">private</span> List&lt;Student&gt; students;<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Student&gt; <span class="hljs-title">getStudents</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> students;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setStudents</span><span class="hljs-params">(List&lt;Student&gt; students)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.students = students;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Clazz&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;classId=&quot;</span> + classId +<br>                <span class="hljs-string">&quot;, className=&#x27;&quot;</span> + className + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, students=&quot;</span> + students +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getClassId</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> classId;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setClassId</span><span class="hljs-params">(<span class="hljs-keyword">int</span> classId)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.classId = classId;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getClassName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> className;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setClassName</span><span class="hljs-params">(String className)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.className = className;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>StudentClassMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--该映射文件的唯一标识符--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.rdleng.mapper.StudentClassMapper&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryStudentByClassId&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Student&quot;</span>&gt;</span><br>        select * from people.student where stuClass  = #&#123;classId&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>conf.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;com/rdleng/mapper/StudentClassMapper.xml&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<p>StudentMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--    一对多延迟加载--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryClassAndStudentByClassIdOMWithLazyLoad&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;class_to_student_lazy_load&quot;</span>&gt;</span><br>        select c.*<br>        from people.class c<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;class_to_student_lazy_load&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Clazz&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;classId&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;classId&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;className&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;className&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;students&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;student&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;com.rdleng.mapper.StudentClassMapper.queryStudentByClassId&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;classId&quot;</span> &gt;</span><br>          <span class="hljs-comment">&lt;!--  &lt;result column=&quot;stuNum&quot; property=&quot;stuNum&quot;/&gt;</span><br><span class="hljs-comment">            &lt;result column=&quot;stuAge&quot; property=&quot;stuAge&quot;/&gt;</span><br><span class="hljs-comment">            &lt;result column=&quot;stuName&quot; property=&quot;stuName&quot;/&gt;</span><br><span class="hljs-comment">            &lt;result column=&quot;stuClass&quot; property=&quot;stuClass&quot;/&gt;</span><br><span class="hljs-comment">            &lt;result column=&quot;stuSex&quot; property=&quot;stuSex&quot;/&gt;--&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">List&lt;Clazz&gt; <span class="hljs-title">queryClassAndStudentByClassIdOMWithLazyLoad</span><span class="hljs-params">()</span></span>;<br></code></pre></td></tr></table></figure>

<p>测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Clazz&gt; clazzes = mapper.queryClassAndStudentByClassIdOMWithLazyLoad();<br>	<span class="hljs-keyword">for</span> (Clazz clazz : clazzes) &#123;<br>		System.out.println(clazz.getClassId() + <span class="hljs-string">&quot;,&quot;</span>+clazz.getClassName());<br>		System.out.println(<span class="hljs-string">&quot;---------&quot;</span>);<br>		List&lt;Student&gt; students2 = clazz.getStudents();<br>		<span class="hljs-keyword">for</span> (Student student : students2) &#123;<br>		System.out.println(student.getStuNum() + <span class="hljs-string">&quot;,&quot;</span> + student.getStuName());<br>            &#125;<br></code></pre></td></tr></table></figure>



<p>1.查询缓存<br>    一级缓存 ：同一个SqlSession对象<br>      MyBatis默认开启一级缓存，如果用同样的SqlSession对象查询相同的数据，<br>    则只会在第一次 查询时 向数据库发送SQL语句，并将查询的结果 放入到SQLSESSION中（作为缓存在）；<br>    后续再次查询该同样的对象时，<br>    则直接从缓存中查询该对象即可（即省略了数据库的访问）</p>
<p><img src="https://raw.githubusercontent.com/rdleng/typora-image/master/img/20200923155550.png" srcset="/img/loading.gif" lazyload alt="image-20200923155544411"></p>
<p>二级缓存<br>MyBatis默认情况没有开启二级缓存，需要手工打开。<br>a.conf.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 开启二级缓存 --&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cacheEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<p>b.在具体的mapper.xml中声明开启(studentMapper.xml中)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;org.lanqiao.mapper.StudentMapper&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 声明次namespace开启二级缓存 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">cache</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<p>根据异常提示：NotSerializableException可知，MyBatis的二级缓存 是将对象 放入硬盘文件中<br>            序列化：内存-&gt;硬盘<br>            反序列化：硬盘-&gt;内存<br>    准备缓存的对象，必须实现了序列化接口 （如果开启的缓存Namespace=”org.lanqiao.mapper.StudentMapper”），可知序列化对象为Student，因此需要将Student序列化 （序列化Student类，以及Student的级联属性、和父类）</p>
<p>​    触发将对象写入二级缓存的时机：SqlSession对象的close()方法。</p>
<p>​    Mybatis自带二级缓存：【同一个namespace】生成的mapper对象</p>
<p>回顾：namespace的值 就是 接口的全类名（包名.类名）， 通过接口可以产生代理对象（studentMapper对象）</p>
<p>–&gt;namespace决定了studentMapper对象的产生<br>结论：只要产生的xxxMapper对象 来自于同一个namespace，则 这些对象 共享二级缓存。<br>注意：二级缓存 的范围是同一个namespace, 如果有多个xxMapper.xml的namespace值相同，则通过这些xxxMapper.xml产生的xxMapper对象 仍然共享二级缓存。</p>
<p>禁用 ：select标签中useCache=”false”</p>
<p>清理：</p>
<p>a.与清理一级缓存的方法相同<br>    commit(); （一般执行增删改时 会清理掉缓存；设计的原因 是为了防止脏数据）<br>    在二级缓存中，commit()不能是查询自身的commit。</p>
<p>commit会清理一级和二级缓存；但是 清理二级缓存时，不能是查询自身的commit；<br>b. 在select标签中 增加属性 flushCache=”true”</p>
<p>命中率：<br>1:  zs :0%<br>2:    50%<br>3:   2/3    0.666<br>4:  3/4     0.75</p>
<p>三方提供的二级缓存：<br>ehcache、memcache<br>要想整合三方提供的二级缓存 （或者自定义二级缓存），必须实现org.apache.ibatis.cache.Cache接口，该接口的默认实现类是PerpetualCache</p>
<p>整合ehcache二级缓存：<br>a.<br>ehcache-core.jar<br>mybatis-Ehcache.jar<br>slf4j-api.jar</p>
<p>b.编写ehcache配置文件 Ehcache.xml</p>
<p>c.开启EhCache二级缓存</p>
<p>在xxxMapper.xml中开启</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">cache</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;</span>&gt;</span><br>	<span class="hljs-comment">&lt;!-- 通过property覆盖Ehcache.xml中的值 --&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxElementsInMemory&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;2000&quot;</span>/&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxElementsOnDisk&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;3000&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">cache</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>2.逆向工程<br>    表、类、接口、mapper.xml四者密切相关，因此 当知道一个的时候  其他三个应该可以自动生成。<br>    表-&gt;其他三个</p>
<pre><code>实现步骤：
a.  mybatis-generator-core.jar、mybatis.jar、ojdbc.jar
b.  逆向工程的配置文件generator.xml
c.  执行
</code></pre>
<h5 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h5><h6 id="1-数据库环境切换-驱动-jar"><a href="#1-数据库环境切换-驱动-jar" class="headerlink" title="1.数据库环境切换 (驱动 jar)"></a>1.数据库环境切换 (驱动 jar)</h6><p>a.切换 environment ( 指定实际使用数据库)<br>b.配置 Provider 别名<br>c.写不同数据库 SQL 语句<br>d.在mappe. xml中配置databaseId=’ Provider别名”<br>如果mapper. xml的 sq1标签仅有一个不带databaseId的标签， 则<br>改标签会自动适应当前数据库。<br>如果既有不带databaseId的标签，又有带databaseId的标签,则程<br>序会优先使用带databaseId的标签</p>
<h6 id="2-注解方式"><a href="#2-注解方式" class="headerlink" title="2.注解方式"></a>2.注解方式</h6><p>推荐使用xml_<br>a.将sq1语句写在接口的方法上@Select(“”) ;<br>b.将接口的全类名写入<mapper>，让mybati s知道sq1语句<br>此时是存储在接口中<br>注解/ xml都支持批量引入，</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>	<span class="hljs-comment">&lt;!--以下可以将com.rdleng.mapper包中的注解接口和xml全部一次性引入--&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.rdleng.mapper’/ &gt;</span></span><br><span class="hljs-string"><span class="hljs-tag">&lt;/mappers&gt;</span></span><br></code></pre></td></tr></table></figure>

<h6 id="3-增删改的返回值问题"><a href="#3-增删改的返回值问题" class="headerlink" title="3.增删改的返回值问题"></a>3.增删改的返回值问题</h6><p>返回值可以是void、Integer、Long、Boolean；在接口中直接修改，不用修改xml文件的resultType<br>如何操作：只需要在接口中修改返回值即可。</p>
<ol start="4">
<li><h6 id="事务自动提交"><a href="#事务自动提交" class="headerlink" title="事务自动提交"></a>事务自动提交</h6></li>
</ol>
<p>手动提交:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">sessionFactory.openSession();<br>session.commit();<br></code></pre></td></tr></table></figure>

<p>自动提交：<br>   每个dml语句 自动提交<br>   <code>sessionFactory.openSession(true);</code></p>
<h6 id="5-自增问题"><a href="#5-自增问题" class="headerlink" title="5.自增问题"></a>5.自增问题</h6><p>MySQL支持自增(回显)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--只需要配置两个属性即可: useGeneratedKeys=&quot;true”keyProperty=&quot;stuNo&quot;--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addStudent&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;com.rdleng.entity.Student”</span></span><br><span class="hljs-string"><span class="hljs-tag">useGeneratedKeys=&quot;</span><span class="hljs-attr">true</span>&quot;<span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;stuNo&quot;</span> &gt;</span><br>	insert into student (stuName,stuAge,graName) values(#&#123;stuName&#125;,#&#123;stuAge&#125;,#&#123;graName&#125;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>Oracal不支持自增：通过序列模拟实现</p>
<p><code>create sequence myseql increment by 1 start with 1;</code><br>序列的两个属性：<br>nextval：序列中下一个值<br>currval：当前值<br><code>insert into student values (myseq.nextval,...);</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--首先执行create sequence myseql increment by 1 start with 1;--&gt;</span><br><span class="hljs-comment">&lt;!--增加一个学生oracal--&gt;</span><br><span class="hljs-comment">&lt;!--方式一：推荐--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot; addStudent&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;com.yanqun.entity.Student&quot;</span> <span class="hljs-attr">databaseId</span>=<span class="hljs-string">&quot;oracle&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">selectKey</span> <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;stuNo&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Integer&quot;</span> <span class="hljs-attr">order</span>=<span class="hljs-string">&quot;BEFORE&quot;</span>&gt;</span><br>		select myseq.nextval from dual<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">selectKey</span>&gt;</span><br>	insert into student(stuno,stuName,stuAge,graName) values (#&#123;stuNo&#125;,# &#123;stuName&#125;,#&#123;stuAge&#125;,#&#123;graName&#125;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>通过<code>&lt;insert&gt;</code>的字标签<code>&lt;selectKey&gt;</code>实现:<br>在 <code>&lt;selectKey&gt;</code>中查询下一个序列(自增后的值)，再将此值传入<code>keyProperty=&quot; stuNo&quot;</code>属性，最后在真正执行时使用该属性值</p>
<p>方式二：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addstudent&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;com.yanqun.entity.Student&quot;</span> <span class="hljs-attr">databaseId</span>=<span class="hljs-string">&quot; oracle&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">selectKey</span> <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;stuNo&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Integer&quot;</span> <span class="hljs-attr">order</span>=<span class="hljs-string">&quot;AFTER&quot;</span>&gt;</span><br>		select myseq. currval from dual<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">selectKey</span>&gt;</span><br>	insert into student(stuno,stuName,stuAge,graName) values(myseq.nextval，#&#123;stuName&#125;,#&#123;stuAge&#125;,#&#123;graName&#125;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h6 id="6-参数问题"><a href="#6-参数问题" class="headerlink" title="6.参数问题"></a>6.参数问题</h6><p>目前将多个参数封装到一个javabean对象(pojo) ,然后使用该对象传递<br>a.传入多个参数时，不用在mapper. xml中编写parameterType<br>异常提示：<br>stuNo不能使用。可以使用的是：<code>[arg3,arg2,arg1,arg0,param4,param3,param2,param1]</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">...</span>&gt;</span><br>insert into student (stuno, stuName, stuAge, graName)<br>values (#&#123;arg0&#125;，#&#123;arg1&#125;, # &#123;arg2&#125;, # &#123;arg3&#125;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>b.命名参数<br>可以在接口中通过@Param(“ sNo”)指定sq1中参数的名字<br><code>public abstract Integer addStudent (@Param(&quot; sNo&#39; ) Integer stuNo,...)</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot; addStudent”databaseId=&quot;</span> <span class="hljs-attr">oracle</span>&quot;&gt;</span><br>	insert into student (stuno, stuName, stuAge, graName)<br>	values (#&#123;sNo&#125;，#&#123;sName&#125;, #&#123;sAge&#125;, #&#123;gName&#125;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>c.综合使用<br><code>Integer addStudent(@Param(&quot;sNo&quot;) Integer stuNo，@Param(”stu&quot;)Student student);</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot; addStudent&quot;</span> <span class="hljs-attr">databaseId</span>=<span class="hljs-string">&quot;oracle&quot;</span>&gt;</span><br>	insert into student (stuno, stuName, stuAge, graName)<br>	values(#&#123;sNo&#125;，#&#123;stu.stuName&#125;, #&#123;stu.stuAge&#125;, #&#123;stu.graName&#125; )<br><span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="7">
<li><h6 id="增null"><a href="#增null" class="headerlink" title="增null"></a>增null</h6></li>
</ol>
<p>  oracle: 如果插入的字段是Null，提示错误: Other 而不是null<br>  mysql: 如果插入的字段是Null， 可以正常执行(没有约束)<br>  原因:<br>  各个数据库在mybatis中对各种数据类型的默认值不一致。<br>  mybatis中，jdbcTypeForNu1l (如果是null)，则默认值0THER。Other来说，MySQL能够处理(NULL) ,但是Qracle不行。<br>  解决:<br>  oracle: null -&gt;OTHER , 需要手工告诉oracle:other - &gt;null<br>  a.修改具体的sql标签<br>  当某个数据类型orac1e无法处理时，告诉它用默认值null;注意，此时设置的jdbcType=NULL不会影响正常的赋值(“zs”)</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot; addStudent”databaseId= oracle&quot;</span> &gt;</span><br>	insert into student (stuno, stuName)<br>		values (#&#123;stuNo&#125;，#&#123;stuName,jdbcType=NULL&#125; )<br><span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>  b.配置mybatis全局配置文件conf.xml(推荐)</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot; jdbcTypeForNu1l”value= ”NULL&quot;</span> /&gt;</span><br>&lt;/ settings&gt;<br></code></pre></td></tr></table></figure>

<h6 id="8-返回值为HashMap的情况"><a href="#8-返回值为HashMap的情况" class="headerlink" title="8.返回值为HashMap的情况"></a>8.返回值为HashMap的情况</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--其中stuNo是数据库的子段名。“no”是stuNo的别名，作为map的key,用于在map中get值时使用map.get(&quot;no”);--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryStudentOutByHashMap&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;HashMap&quot;</span>&gt;</span><br>	select stuNo &quot;no&quot;,stuName &quot;name&quot;,stuAge &quot;age&quot; from student where stuNo =    		#&#123;stuNo&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>如果不加别名，则map的key就是 字段名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryStudentOutByHashMap” parameterType=&quot;</span><span class="hljs-attr">int</span>&quot; <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;HashMap&quot;</span>&gt;</span><br>	select stuNo, stuName, stuAge<br>		from student where stuNo = #&#123;stuNo&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p> 思考:<br>STUNAME: xx007 STUAGE:77 STUNO: 11<br>STUNAME</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">33</span>			ZS			<span class="hljs-number">22</span><br><span class="hljs-attribute">34</span>			ls			<span class="hljs-number">22</span><br><span class="hljs-attribute">45</span>			WW		    <span class="hljs-number">33</span><br><span class="hljs-attribute">87</span>			Z<span class="hljs-number">1</span>			<span class="hljs-number">69</span><br></code></pre></td></tr></table></figure>

<p>map :<br>key: STUNO    value: Student</p>
<p>map :<br>key: STUNO    value: Student</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*程序根据select的返回值 知道map的value就是Student,根据@MapKey(&quot;stuNo&quot;)知道map的key是stuNo*/</span><br><span class="hljs-meta">@MapKey(&quot;STUNO&quot;)</span><br>HashMap&lt; Integer, Student&gt; <span class="hljs-function">queryStudent <span class="hljs-title">sByHashMap</span><span class="hljs-params">()</span> </span>;<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryStudentsByHashMap” resultType=&quot;</span><span class="hljs-attr">HashMap</span>&quot; &gt;</span><br>	select stuNo ，stuName , stuAge from student<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>在resultMap中 还可以使用鉴别器:对相同sq1中不同字段值进行判断，从而进行不同的处理。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--数据库中有真名和昵称；</span><br><span class="hljs-comment">通过使用釜别器:对查询结果进行分支处理:</span><br><span class="hljs-comment"> 如果是a年级，则真名赋值给对象的stuName属性，如果b年级，显示昵称--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">resultMap...</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">...</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">result...</span>/&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">discriminator</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;string&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;gname&quot;</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">case</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;a&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.yanqun.entity.Student&quot;</span> &gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;sname&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;stuName&quot;</span>/&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">case</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">case</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;b&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.yanqun.entity.Student&quot;</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;nickname&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot; stuName&quot;</span>/&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">case</span>&gt;</span><br>	&lt;/ discriminator&gt;<br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h6 id="9-别名问题"><a href="#9-别名问题" class="headerlink" title="9.别名问题"></a>9.别名问题</h6><p>如果在批量设置别名时，出现了冲突。可以使用@Alias(“myStudent”)区分。</p>
<h6 id="10-内置参数"><a href="#10-内置参数" class="headerlink" title="10.内置参数"></a>10.内置参数</h6><p>_parameter：代表mybatis的输入参数。</p>
<p>_databaseId：当前数据库的值。</p>
<h6 id="11-模糊查询"><a href="#11-模糊查询" class="headerlink" title="11.模糊查询"></a>11.模糊查询</h6><ul>
<li><p>${}：原样输出；#：自动拼接引号</p>
</li>
<li><p>传值时，直接传%x%</p>
</li>
<li><p>bind参数</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--把传入的参数拼接%%，赋值给_queryName--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bind</span> <span class="hljs-attr">name</span>= =<span class="hljs-string">”_queryName</span>&quot; <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&#x27;%&#x27;+tuName+&#x27;%&#x27;&quot;</span>/&gt;</span><br>select * from student where stuName like #&#123;_ queryName&#125; <br></code></pre></td></tr></table></figure>

<p>通过bind将传入的stuName进行了处理（增加了%…%）</p>
</li>
</ul>
<h5 id="逆向工程的使用"><a href="#逆向工程的使用" class="headerlink" title="逆向工程的使用"></a>逆向工程的使用</h5><ol>
<li><p>jar(mybatis.jar、mybatis-generator-core.jar、mysql-connector-java.jar)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>	<br>	<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.generator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-generator-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.16<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>db.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#mysql</span><br><span class="hljs-attr">driver</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br><span class="hljs-attr">uri</span>=<span class="hljs-string">jdbc:mysql://localhost:3306?people&amp;serverTimezone=GMT</span><br><span class="hljs-attr">user</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">password</span>=<span class="hljs-string">123456</span><br></code></pre></td></tr></table></figure></li>
<li><p>xml模板文件（修改生成路径、表）<br>resource路径下新建<a href="./generatorxml.md">generator.xml</a>文件<br>引入数据库信息<br><code>&lt;properties resource=&quot;db.properties/&quot;&gt;</code><br>添加conf.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;uri&#125;&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;user&#125;&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--        加载映射文件--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;personMapper.xml&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>修改以下信息</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">jdbcConnection</span> <span class="hljs-attr">driverClass</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span> <span class="hljs-attr">connectionURL</span>=<span class="hljs-string">&quot;$&#123;uri&#125;&quot;</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">&quot;$&#123;user&#125;&quot;</span> <span class="hljs-attr">password</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">jdbcConnection</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">javaModelGenerator</span> <span class="hljs-attr">targetPackage</span>=<span class="hljs-string">&quot;com.rdleng.entry&quot;</span> 			<span class="hljs-attr">targetProject</span>=<span class="hljs-string">&quot;src/main/java&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;constructorBased&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;enableSubPackages&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;immutable&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;rootClass&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com._520it.mybatis.domain.BaseDomain&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;trimStrings&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">javaModelGenerator</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">sqlMapGenerator</span> <span class="hljs-attr">targetPackage</span>=<span class="hljs-string">&quot;com.rdleng.mapper&quot;</span> <span class="hljs-attr">targetProject</span>=<span class="hljs-string">&quot;src/main/java&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;enableSubPackages&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">sqlMapGenerator</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">javaClientGenerator</span> <span class="hljs-attr">targetPackage</span>=<span class="hljs-string">&quot;com.rdleng.mapper&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;XMLMAPPER&quot;</span>     <span class="hljs-attr">targetProject</span>=<span class="hljs-string">&quot;src/main/java&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;enableSubPackages&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">javaClientGenerator</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">tableName</span>=<span class="hljs-string">&quot;student&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>根据java模板类一键生成</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.rdleng.test;<br><br><span class="hljs-keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;<br><span class="hljs-keyword">import</span> org.mybatis.generator.config.Configuration;<br><span class="hljs-keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;<br><span class="hljs-keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;<br><br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-09-24 20:48</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestMybatis</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        File file = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;src\\main\\resources\\generator.xml&quot;</span>);<br>        List&lt;String&gt; warnings = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        ConfigurationParser configurationParser = <span class="hljs-keyword">new</span> ConfigurationParser(warnings);<br>        Configuration config = configurationParser.parseConfiguration(file);<br>        DefaultShellCallback callback = <span class="hljs-keyword">new</span> DefaultShellCallback(<span class="hljs-keyword">true</span>);<br>        MyBatisGenerator generator = <span class="hljs-keyword">new</span> MyBatisGenerator(config, callback, warnings);<br>        generator.generate(<span class="hljs-keyword">null</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h5 id="Mybatis架构和源码"><a href="#Mybatis架构和源码" class="headerlink" title="Mybatis架构和源码"></a>Mybatis架构和源码</h5><img src="https://raw.githubusercontent.com/rdleng/typora-image/master/img/20200925070501.png" srcset="/img/loading.gif" lazyload alt="mybatis架构" style="zoom:60%;" />

<p>Mybatis执行过程：</p>
<ol>
<li>获取SqlSessionFactory对象</li>
<li>获取SqlSession对象</li>
<li>获取XxxMapper对象（代理接口中的方法、xml中的<select>等标签）</li>
<li>执行<select>等标签中定义的SQL语句</li>
</ol>
<ul>
<li><p>获取SqlSessionFactory<br>parser解析器<br>通过parseConfiguration()方法设置了properties、settings、enviroments等属性标签<br>将所有配置信息放在Configuration对象中<br>解析所有的mapper.xml文件（分析其中的增删改查标签）<br><code>&lt;select id=&quot;&quot; resultType=&quot;&quot;等属性是通过 parseStatementNode()解析的&gt;</code></p>
<p>将XxxMapper.xml中的<select>等标签解析成MappedStatement对象，即MappedStatement对象就是<select>等标签<br>MappedStatement对象存在于Configuration中；<br>Enviroment对象存在于Configuration中<br><strong>所有的配置信息、增删改查标签 全部存在于Configuration中</strong><br>Configuration又存在于DefaultSqlSessionFactory对象中（SqlSessionFactory）<br><strong>SqlSessionFactory对象 -&gt; DefaultSqlSessionFactory -&gt; Configuration -&gt; 包含了一切配置信息</strong></p>
</li>
<li><p>获取SqlSession对象<br>configuration.newExecutor(tx,exeType); -&gt; SimpleExecutor<br>根据不同的execType，产生不同的Executor，并会对执行器做拦截操作：<br>executor = (Executor)interceptorChain.pluginAll(executor);<br>通过装饰模式，将刚才产生的executor包装成一个更加强大的executor<br>作用：以后如果要给MyBatis写自己的插件，就可以通过拦截器实现。<br>插件开发：1写插件2放入拦截器<br>返回DefaultSqlSession (configurat ion, executor,事务)<br>sqlSession -&gt; openSession() -&gt; openSessionFromDataSource() -&gt; DefaultSqlSession对象<br>sqlSession -&gt; DefaultSqlSession对象 -&gt; 执行SQL</p>
</li>
<li><p>获取XxxMapper对象、执行<br>执行增删改查 -&gt; MapperProxy/invoke() –&gt; InvocationHandler：JDK动态代理接口<br>用到了动态代理模式：增删改查 -&gt; 代理对象（MapperProxy对象）-&gt; 代理对象帮我们”代理执行“增删改查<br>mapperMethod.execute(sqlSession.args)：实际调用增删改查的方法，依靠了SqlSession中的configuration和executor..<br>处理增删改查方法的参数：method.convertArgsToSqlCommandParam(args);如果是0个，返回null;如果是1个，返回第一个；如果有多个参数，放入map中<br>查询方法：selectOne() -&gt; selectList()：configuration.getMappedStatement()即获取到用于增删改查的对象。<br>boundSql：将我们写的SQL和参数值进行了拼接后的对象，即最终能够被执行的SQL<br>执行SQL是通过Executor<br>如果缓存中没有要查询的内容，则进入数据库 真实查询：queryFromDataBase()<br>mybatis使用的jdbc对象是PreparedStatement<br>底层执行增删改查：PreparedStatement的execute()<br>mybatis底层在执行CRUD时，可能会涉及到四个处理器：StatementHandler、ParametorHandler、TypeHandler、ResultSetHandler<br><img src="https://raw.githubusercontent.com/rdleng/typora-image/master/img/20200925101546.png" srcset="/img/loading.gif" lazyload alt="四大处理器Handler"><br>XxxMapper：SqlSession(configuration,executor,事务)、代理接口的对象（MapperInterface）、MethodCache(存放查询缓存，底层是ConcurrentHashMap)</p>
</li>
</ul>
<h6 id="自定义插件"><a href="#自定义插件" class="headerlink" title="自定义插件"></a>自定义插件</h6><p>四大处理：StatementHandler ParameterHandler TypeHandler ResultSetHandler<br>四大核心对象：StatementHandler ParameterHandler ResultSetHandler Executor</p>
<p>四大核心对象：1、都涉及到了 拦截器 用于增强 2、四大核心对象都包含了 该增强操作<br>自定义插件的编写逻辑：根据MyBatis规则 编写一个拦截器，在拦截器内部加入自定义增强功能</p>
<p>步骤：</p>
<ol>
<li><p>编写拦截器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Interceptor</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-comment">//拦截</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">intercept</span><span class="hljs-params">(Invocation invocation)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;拦截方法...intercept()...&quot;</span>);<br>        Object proceed = invocation.proceed();<span class="hljs-comment">//放行</span><br>        <span class="hljs-keyword">return</span> proceed;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">plugin</span><span class="hljs-params">(Object target)</span> </span>&#123;<span class="hljs-comment">//将拦截器中定义的增强功能和原来的核心对象合并起来，称为最终的核心对象</span><br>        Object wrap = Plugin.wrap(target, <span class="hljs-keyword">this</span>);<br>        <span class="hljs-keyword">return</span> wrap;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setProperties</span><span class="hljs-params">(Properties properties)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;设置属性&quot;</span> + properties);<span class="hljs-comment">//设置属性</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>编写签名注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Intercepts(&#123;@Signature(type = StatementHandler.class, method = &quot;query&quot;, args = &#123;</span><br><span class="hljs-meta">        Statement.class, ResultSetHandler.class</span><br><span class="hljs-meta">&#125;)&#125;)</span><br></code></pre></td></tr></table></figure></li>
<li><p>配置conf.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--&lt;environment&gt;之前--&gt;</span> <br><span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span> <span class="hljs-attr">interceptor</span>=<span class="hljs-string">&quot;my.interceptors.MyInterceptor&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;zs&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;age&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;23&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>编写多个拦截器时，执行顺序和<code>&lt;plugins&gt;</code>配置顺序一致</p>
</li>
</ol>
<p>插件<br>select * from student -&gt; 拦截器<br>目标对象target的包装后的产物 -&gt; metaObject.getValue(“可以从target中获取”);<br>通过打印语句 可知，target就是 RoutingStatementHandler<br>–&gt;metaObject.getValue(“可以从RoutingStatementHandler中获取boundSql、parameterHandler”)<br>–&gt;metaObject.getValue(“parameterHandler.parameterObject”)<br>    metaObject.getValue(“parameterHandler.boundSql”) //XxxMapper.xml中的sql语句中的参数值<br>–&gt;只研究<br>    metaObject.getvalue(“parameterHandler.parameterObject”)<br>     metaObject.getValue(“parameterHandler.boundSql.sql”,”select * from book…”)<br>     metaObject.getValue(“parameterHandler.boundSql.parameterObject”,2)  </p>
<p>拦截器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> my.interceptors;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.executor.statement.StatementHandler;<br><span class="hljs-keyword">import</span> org.apache.ibatis.plugin.*;<br><span class="hljs-keyword">import</span> org.apache.ibatis.reflection.MetaObject;<br><span class="hljs-keyword">import</span> org.apache.ibatis.reflection.SystemMetaObject;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.ResultHandler;<br><br><span class="hljs-keyword">import</span> java.sql.Statement;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-09-25 10:27</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Intercepts(&#123;@Signature(type = StatementHandler.class,</span><br><span class="hljs-meta">//        method = &quot;query&quot;, args = &#123;</span><br><span class="hljs-meta">        method = &quot;parameterize&quot;, args = &#123;</span><br><span class="hljs-meta">        Statement.class</span><br><span class="hljs-meta">&#125;)&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Interceptor</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-comment">//拦截</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">intercept</span><span class="hljs-params">(Invocation invocation)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;拦截方法...intercept()...&quot;</span>);<br>        Object target = invocation.getTarget();<br>        System.out.println(<span class="hljs-string">&quot;目标对象：&quot;</span>+target);<br>        MetaObject metaObject = SystemMetaObject.forObject(target);<br>        Object value = metaObject.getValue(<span class="hljs-string">&quot;parameterHandler.parameterObject&quot;</span>);<br>        System.out.println(value+<span class="hljs-string">&quot;------&quot;</span>);<br>        metaObject.setValue(<span class="hljs-string">&quot;parameterHandler.parameterObject&quot;</span>,<span class="hljs-number">3</span>);<br>        Object proceed = invocation.proceed();<span class="hljs-comment">//放行</span><br>        <span class="hljs-keyword">return</span> proceed;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">plugin</span><span class="hljs-params">(Object target)</span> </span>&#123;<span class="hljs-comment">//将拦截器中定义的增强功能和原来的核心对象合并起来，称为最终的核心对象</span><br>        Object wrap = Plugin.wrap(target, <span class="hljs-keyword">this</span>);<br>        <span class="hljs-keyword">return</span> wrap;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setProperties</span><span class="hljs-params">(Properties properties)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;设置属性&quot;</span> + properties);<span class="hljs-comment">//设置属性</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.rdleng.test;<br><br><span class="hljs-keyword">import</span> com.rdleng.entry.Student;<br><span class="hljs-keyword">import</span> com.rdleng.entry.StudentExample;<br><span class="hljs-keyword">import</span> com.rdleng.mapper.StudentMapper;<br><span class="hljs-keyword">import</span> com.rdleng.mapper.StudentMapperExt;<br><span class="hljs-keyword">import</span> org.apache.ibatis.io.Resources;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.Reader;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> rdleng</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@mail</span> rdleng@foxmail.com</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-09-24 22:42</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestGeneratorDemo</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        Reader reader = Resources.getResourceAsReader(<span class="hljs-string">&quot;conf.xml&quot;</span>);<br>        SqlSessionFactory factory = <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder().build(reader);<br>        SqlSession session = factory.openSession();<br>        StudentMapperExt mapper = session.getMapper(StudentMapperExt.class);<br>        Student students = mapper.queryStudentByStuId(<span class="hljs-number">1</span>);<br>        System.out.println(students);<br>        session.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h6 id="批量操作DML"><a href="#批量操作DML" class="headerlink" title="批量操作DML"></a>批量操作DML</h6><p><code>sessionFactory.openSession(ExecutorType.BATCH);</code> 推荐的方式</p>
<p>BASH：预编译SQL一次，其余次数 只需要设置参数值即可<br>没有BASH：预编译N次，每次DML都需要执行完整的SQL</p>
<p>不推荐的方式：拼接SQL </p>
<p>oracle:批量插入<br>a. create table 表 select … from 旧表<br>b. insert into 表（…） select .. from 表；<br>c. begin ..(DML).. end;<br>d. 数据泵、SQL Loader、外部表<br>以 begin ..DML.. end为例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sqk">begin <br>    insert into student(stuno,stuname) values (1,&quot;zs&quot;);<br>    insert into student(stuno,stuname) values (2,&quot;ls&quot;);<br>end;<br></code></pre></td></tr></table></figure>

<p>–核心：将SQL拼接成oracle能够执行的SQL；collection的参数必须是collection或List</p>
<p>MySQL：批量插入<br><code>insert into student(stuNo,stuName) values(100,&#39;zs&#39;),(200,&#39;ls&#39;)</code></p>
<p>这种批量插入方式不推荐：1. 没有用到Mybatis对批量插入的支持 2.不适合数据库迁移 3.如果有大量数据，则会将拼接的SQL语句拉的很长，而部分数据库对SQL语句的长度有限制。</p>
<h6 id="分页插件"><a href="#分页插件" class="headerlink" title="分页插件"></a>分页插件</h6><p><a target="_blank" rel="noopener" href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/en/HowToUse.md">Page Helper</a></p>
<ol>
<li><p>添加Maven依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.pagehelper<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>配置拦截器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span> <span class="hljs-attr">interceptor</span>=<span class="hljs-string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- config params as the following --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;param1&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;value1&quot;</span>/&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"> Page&lt;Object&gt; page  = PageHelper.startPage(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>);<br>List&lt;User&gt; list = userMapper.selectIf(<span class="hljs-number">1</span>);<br><span class="hljs-comment">//根据page获取分页信息 page.getXxx();</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">或将查询结果list作为参数传入PageInfo构造方法</span><br><span class="hljs-comment">  PageInfo&lt;Student&gt; pageInfo = new PageInfo&lt;&gt;(list);</span><br><span class="hljs-comment">  pageInfo.getXxx();//pageInfo比page更为强大</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h6 id="Mybatis-Plus"><a href="#Mybatis-Plus" class="headerlink" title="Mybatis Plus"></a>Mybatis Plus</h6><p><a target="_blank" rel="noopener" href="https://baomidou.com/">MyBatis-Plus</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>ORM(hibernate mybatis jpa)：数据 student (no,name)  对象Student<br>(studentNo,studentName)</p>
<p>Mybatis + MyBatisPlus：只做增强，不做改变</p>
<p>前置课程：maven + Spring + mybatis</p>
<p>开发MyBatis Plus<br>    1.jar<br>    2.数据表（student） 类（Student）<br>    3.MyBatis配置文件</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/09/16/IDEA/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">IDEA 快捷键</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/09/06/Git/">
                        <span class="hidden-mobile">Git</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                

              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  

  

  

  

  

  




  
<script src="/js/clicklove.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/dianjichuzi.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
